SELECT
    t.REPORT_BATCH_FILE_NAME,
    v1.Data,
    t.Domain
FROM
    TRB_REPORT_DICC_ESMA_RFT t
JOIN
    V_TRB_REP_ETD_TRD_DTCC_ESMA_RFT v1
ON
    t.REPORT_BATCH_FILE_NAME = v1.REPORT_BATCH_FILE_NAME
    AND v1.FILE_LINE_NO = -1
    AND (t.Domain = 'TOPAZ' OR t.Domain = 'GMI_ETD')
UNION ALL
SELECT
    t.REPORT_BATCH_FILE_NAME,
    v2.Data,
    t.Domain
FROM
    TRB_REPORT_DICC_ESMA_RFT t
JOIN
    V_TRB_REP_ETD_POS_DTCC_ESMA_RFT v2
ON
    t.REPORT_BATCH_FILE_NAME = v2.REPORT_BATCH_FILE_NAME
    AND v2.FILE_LINE_NO = -1
    AND (t.Domain = 'TOPAZ_POS' OR t.Domain = 'GMI_ETD_POS')
UNION ALL
SELECT
    t.REPORT_BATCH_FILE_NAME,
    v3.Data,
    t.Domain
FROM
    TRB_REPORT_DICC_ESMA_RFT t
JOIN
    V_TRB_REP_OTC_TRD_DTCC_ESMA_RFT v3
ON
    t.REPORT_BATCH_FILE_NAME = v3.REPORT_BATCH_FILE_NAME
    AND v3.FILE_LINE_NO = -1
    AND t.Domain = 'GMI_OTC'
UNION ALL
SELECT
    t.REPORT_BATCH_FILE_NAME,
    v4.Data,
    t.Domain
FROM
    TRB_REPORT_DICC_ESMA_RFT t
JOIN
    V_TRB_REP_ETD_TRD_DTCC_ESMA_RFT v4
ON
    t.REPORT_BATCH_FILE_NAME = v4.REPORT_BATCH_FILE_NAME
    AND v4.FILE_LINE_NO = 9999999
    AND (t.Domain = 'TOPAZ' OR t.Domain = 'GMI_ETD')
UNION ALL
SELECT
    t.REPORT_BATCH_FILE_NAME,
    v5.Data,
    t.Domain
FROM
    TRB_REPORT_DICC_ESMA_RFT t
JOIN
    V_TRB_REP_ETD_POS_DTCC_ESMA_RFT v5
ON
    t.REPORT_BATCH_FILE_NAME = v5.REPORT_BATCH_FILE_NAME
    AND v5.FILE_LINE_NO = 9299999
    AND (t.Domain = 'TOPAZ_POS' OR t.Domain = 'GMI_ETD_POS')
UNION ALL
SELECT
    t.REPORT_BATCH_FILE_NAME,
    v6.Data,
    t.Domain
FROM
    TRB_REPORT_DICC_ESMA_RFT t
JOIN
    V_TRB_REP_OTC_TRD_DTCC_ESMA_RFT v6
ON
    t.REPORT_BATCH_FILE_NAME = v6.REPORT_BATCH_FILE_NAME
    AND v6.FILE_LINE_NO = 9999998
    AND t.Domain = 'GMI_OTC';
